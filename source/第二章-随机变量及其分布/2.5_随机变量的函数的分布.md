### §5 随机变量的函数的分布
在实际中，我们常对某些随机变量的函数更感兴趣。例如，在一些试验中，所关心的随机变量往往不能由直接测量得到，而它却是某个能直接测量的随机变量的函数。比如我们能测量圆轴截面的直径$d$，而关心的却是截面面积$A = \frac{1}{4} \pi d^2$。这里，随机变量$A$是随机变量$d$的函数。在这一节中，我们将讨论如何由已知的随机变量$X$的概率分布去求得它的函数$Y = g(X) (g(\cdot))$是已知的连续函数$Y$的概率分布。这里$Y$是这样的随机变量，当$X$取值$x$时，$Y$取值$g(x)$。
例1 设随机变量$X$具有以下的分布律，试求$Y = (X-1)^2$的分布律。
$$
\begin{array}{c|cccc}
X &-1 & 0 & 1 & 2 \\
\hline
p_k & 0.2 & 0.3 & 0.1 & 0.4 \\
\end{array}
$$
解$Y$所有可能取的值为$0, 1, 4$。由
$$
P(Y = 0) = P((X- 1)^2 = 0) = P(X = 1) = 0.1,
$$
$$
P(Y = 1) = P(X = 0) + P(X = 2) = 0.7,
$$
$$
P(Y = 4) = P(X =-1) = 0.2,
$$
即得$Y$的分布律为
$$
\begin{array}{c|ccc}
Y & 0 & 1 & 4 \\
\hline
p_k & 0.1 & 0.7 & 0.2
\end{array}
$$
例2 设随机变量$X$具有概率密度
$$
f_X(x) = \left\lbrace \begin{array}{ll}
\frac{x}{8}, & 0 < x < 4, \\
0, & 其他.
\end{array} \right.
$$
求随机变量$Y = 2X + 8$的概率密度。
解 分别记$X, Y$的分布函数为$F_X(x), F_Y(y)$。下面先来求$F_Y(y)$。
$$
F_Y(y) = P(Y \leq y) = P(2X + 8 \leq y)
$$
$$
= P\left(X \leq \frac{y- 8}{2}\right) = F_X\left(\frac{y- 8}{2}\right).
$$
将$F_Y(y)$关于$y$求导数，得$Y = 2X + 8$的概率密度为
$$
f_Y(y) = f_X\left(\frac{y- 8}{2}\right) \cdot \frac{1}{2}
$$
$$
= \left\lbrace \begin{array}{ll}
\frac{1}{8} \left(\frac{y- 8}{2}\right) \cdot \frac{1}{2}, & 0 < \frac{y- 8}{2} < 4, \\
0, & 其他
\end{array} \right.
$$
$$
= \left\lbrace \begin{array}{ll}
\frac{y- 8}{32}, & 8 < y < 16, \\
0, & 其他.
\end{array} \right.
$$
例3 设随机变量$X$具有概率密度$f_X(x),-\infty < x < \infty$，求$Y = X^2$的概率密度。
解 分别记$X, Y$的分布函数为$F_X(x), F_Y(y)$。先来求$Y$的分布函数$F_Y(y)$。由于$Y = X^2 \geq 0$，故当$y \leq 0$时$F_Y(y) = 0$。当$y > 0$时有
$$
F_Y(y) = P(Y \leq y) = P(X^2 \leq y)
$$
$$
= P(-\sqrt{y} \leq X \leq \sqrt{y})
$$
$$
= F_X(\sqrt{y})- F_X(-\sqrt{y}).
$$
将$F_Y(y)$关于$y$求导数，即得$Y$的概率密度为
$$
f_Y(y) =
\begin{cases}
\frac{1}{2\sqrt{y}}[f_X(\sqrt{y}) + f_X(-\sqrt{y})], & y > 0, \\
0, & y \leq 0.
\end{cases}
\tag{5.1}
$$
例如，设$X \sim N(0, 1)$，其概率密度为
$$
\varphi(x) = \frac{1}{\sqrt{2\pi}} e^{-x^2/2},-\infty < x < \infty.
$$
由(5.1)得$Y = X^2$的概率密度为
$$
f_Y(y) =
\begin{cases}
\frac{1}{\sqrt{2\pi}} y^{-1/2} e^{-y/2}, & y > 0, \\
0, & y \leq 0.
\end{cases}
$$
此时称$Y$服从自由度为 1 的$\chi^2$分布。
上述两个例子解法的关键一步是在“$Y \leq y$”中，即在“$g(X) \leq y$”中解出$X$，从而得到一个与“$g(X) \leq y$”等价的$X$的不等式，并以后者代替“$g(X) \leq y$”。例如，在例 2 中以“$X \leq \frac{y-8}{2}$”代替“$2X + 8 \leq y$”；在例 3 中，当$y > 0$时以“$-\sqrt{y} \leq X \leq \sqrt{y}$”代替“$X^2 \leq y$”。一般来说，可以用这样的方法①求连续型随机变量的函数的分布函数或概率密度。下面我们仅对$Y = g(X)$，其中$g(\cdot)$是严格单调函数的情况，写出一般的结果。
**定理** 设随机变量$X$具有概率密度$f_X(x)$，$-\infty < x < \infty$，又设函数$g(x)$处处可导且恒有$g'(x) > 0$（或恒有$g'(x) < 0$），则$Y = g(X)$是连续型随机变量，其概率密度为
$$
f_Y(y) =
\begin{cases}
f_X[h(y)] | h'(y) |, & \alpha < y < \beta, \\
0, & 其他,
\end{cases}
\tag{5.2}
$$
其中$\alpha = \min\lbrace g(-\infty), g(\infty)\rbrace$，$\beta = \max\lbrace g(-\infty), g(\infty)\rbrace$，$h(y)$是$g(x)$的反函数。
我们只证$g'(x) > 0$的情况。此时$g(x)$在$(-\infty, \infty)$严格单调增加，它的反函数$h(y)$存在，且在$(\alpha, \beta)$严格单调增加，可导。分别记$X, Y$的分布函数为$F_X(x), F_Y(y)$。现在先来求$Y$的分布函数$F_Y(y)$。
因为$Y = g(X)$在$(\alpha, \beta)$取值，故当$y \leq \alpha$时$F_Y(y) = P(Y \leq y) = 0$；当$y \geq \beta$时，$F_Y(y) = P(Y \leq y) = 1$。
当$\alpha < y < \beta$时，
$$
F_Y(y) = P\lbrace Y \leq y\rbrace = P\lbrace g(X) \leq y\rbrace = P\lbrace X \leq h(y)\rbrace = F_X[h(y)].
$$
将$F_Y(Y)$关于$y$求导数，即得$Y$的概率密度
$$
f_Y(y) =
\begin{cases}
f_X[h(y)] h'(y), & \alpha < y < \beta, \\
0, & \text{其他}.
\end{cases}
$$
(5.3)
对于$g'(x) < 0$的情况可以同样地证明，此时有
$$
f_Y(y) =
\begin{cases}
f_X[h(y)] [-h'(y)], & \alpha < y < \beta, \\
0, & \text{其他}.
\end{cases}
$$
(5.4)
① 连续型随机变量$X$的函数$Y = g(X)$不一定是连续型的随机变量。
合并(5.3)与(5.4)两式，(5.2)得证。 □
若$f(x)$在有限区间$[a, b]$以外等于零，则只需假设在$[a, b]$上恒有$g'(x) > 0$（或恒有$g'(x) < 0$），此时
$$
a = \min \lbrace g(a), g(b) \rbrace, \beta = \max \lbrace g(a), g(b) \rbrace.
$$
例4 设随机变量$X \sim N(\mu, \sigma^2)$。试证明$X$的线性函数$Y = aX + b$（$a \neq 0$）也服从正态分布。
证$X$的概率密度为
$$
f_X(x) = \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x- \mu)^2}{2\sigma^2}},-\infty < x < \infty.
$$
现在$y = g(x) = ax + b$，由这一式子解得
$$
x = h(y) = \frac{y- b}{a}, \text{且有 } h'(y) = \frac{1}{a}.
$$
由(5.2)式得$Y = aX + b$的概率密度为
$$
f_Y(y) = \frac{1}{|a|} f_X \left( \frac{y- b}{a} \right),-\infty < y < \infty.
$$
即
$$
f_Y(y) = \frac{1}{|a|} \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x- b- \mu)^2}{2\sigma^2}} = \frac{1}{|a|\sigma\sqrt{2\pi}} e^{-\frac{(y- (b + a\mu))^2}{2(a\sigma)^2}},-\infty < y < \infty.
$$
即有
$$
Y = aX + b \sim N(a\mu + b, (a\sigma)^2).
$$
特别，在上例中取$a = \frac{1}{\sigma}, b =-\frac{\mu}{\sigma}$得
$$
Y = \frac{X- \mu}{\sigma} \sim N(0, 1).
$$
这就是上一节引理的结果。 □
例5 设电压$V =A \sin \Theta$，其中$A$是一个已知的正常数，相角$\Theta$是一个随机
变量，且有$\Theta \sim U\left(-\frac{\pi}{2}, \frac{\pi}{2}\right)$，试求电压$V$的概率密度。
解 现在$v = g(\theta) =A \sin \theta$在$\left(-\frac{\pi}{2}, \frac{\pi}{2}\right)$上恒有$g'(\theta) =A \cos \theta > 0$，且有反函数
$$
\theta = h(v) = \arcsin \frac{v}{A}, \quad h'(v) = \frac{1}{\sqrt{A^2- v^2}},
$$
又，$\Theta$的概率密度为
$$
f(\theta) =
\begin{cases}
\frac{1}{\pi}, &-\frac{\pi}{2} < \theta < \frac{\pi}{2}, \\
0, & \text{其他}.
\end{cases}
$$
由(5.2)式得$V =A \sin \theta$的概率密度为
$$
\psi(v) =
\begin{cases}
\frac{1}{\pi} \cdot \frac{1}{\sqrt{A^2- v^2}}, &-A < v <A, \\
0, & \text{其他}.
\end{cases}
$$
若在上题中$\theta \sim U(0, \pi)$，因为此时$v = g(\theta) =A \sin \theta$在$(0, \pi)$上不是单调函数，上述定理失效，应仍按例3的方法来做。请读者自行求出其结果。
小结
随机变量$X = X(e)$是定义在样本空间$S = \lbrace e\rbrace$上的实值单值函数。也就是说，它是随机试验结果的函数。它的取值随试验的结果而定，是不能预先确定的，它的取值有一定的概率。随机变量的引入，使概率论的研究由个别随机事件扩大为随机变量所表征的随机现象的研究。今后，我们主要研究随机变量和它的分布。
一个随机变量，如果它所有可能的值是有限个或可列无限个，这种随机变量称为离散型随机变量，不是这种情况则称为非离散型的。不论是离散型的或非离散型的随机变量$X$，都可以借助分布函数
$$
F(x) = P\lbrace X \leq x\rbrace, \quad-\infty < x < \infty
$$
来描述。若已知随机变量$X$的分布函数，就能知道$X$落在任一区间$(x_1, x_2]$上的概率
$$
P\lbrace x_1 < X \leq x_2\rbrace = F(x_2)- F(x_1), \quad x_1 < x_2.
$$
这样，分布函数就能完整地描述随机变量取值的统计规律性。
对于离散型随机变量，我们需要掌握的是它可能取哪些值，以及它以怎样的概率取这些值，这就是离散型随机变量取值的统计规律性。因此，对于离散型随机变量，用分布律
$$
P(X = x_k) = p_k, \quad k = 1, 2, \cdots 
$$
或写成
$$
\begin{array}{c|cccc}
X & x_1 & x_2 & \cdots & x_k & \cdots \\
\hline
p_k & p_1 & p_2 & \cdots & p_k & \cdots 
\end{array}
$$
(这里，$\sum_{k=1}^{\infty} p_k = 1$) 来描述它的取值的统计规律性较为直观和简洁。分布律与分布函数有以下的关系
$$
F(x) = P(X \leq x) = \sum_{x_k \leq x} P(X = x_k),
$$
它们是一一对应的。
设随机变量$X$的分布函数为$F(x)$，如果存在非负可积函数$f(x)$，使得对于任意$x$，有
$$
F(x) = \int_{-\infty}^{x} f(x) dx,
$$
则称$X$是连续型随机变量，其中$f(x) \geq 0$称为$X$的概率密度。
给定$X$的概率密度$f(x)$就能确定$F(x)$，由于$f(x)$位于积分号之内，故改变$f(x)$在个别点上的函数值并不改变$F(x)$的值。因此，改变$f(x)$在个别点上的值，是无关紧要的。
连续型随机变量$X$的分布函数是连续的，连续型随机变量取任一指定实数值$a$的概率
为0，即$P(X = a) = 0$。这两点性质离散型随机变量是不具备的。
我们将随机变量分成为
$$
\begin{array}{c}
\text{离散型} \\
\text{随机变量} \\
\quad \text{非离散型} \\
\quad \text{连续型} \\
\quad \text{其他}
\end{array}
$$
读者不要误以为，一个随机变量，如果它不是离散型的那一定是连续型的。但本书只讨论两类重要的随机变量：离散型和连续型随机变量。
读者应掌握分布函数、分布律、概率密度的性质。本章引入了几种重要的随机变量的分布：(0-1)分布，二项分布，泊松分布，指数分布，均匀分布和正态分布。读者必须熟知这几种随机变量的分布律或概率密度。
随机变量$X$的函数$Y = g(X)$也是一个随机变量，要掌握如何由已知的$X$的分布（$X$的分布律或概率密度）去求得$Y = g(X)$的分布（$Y$的分布律或概率密度）。
### 重要术语及主题
随机变量 分布函数 离散型随机变量及其分布律 连续型随机变量及其概率密度 伯努利试验 (0-1)分布 n 重伯努利试验 二项分布 泊松分布 指数分布 均匀分布 正态分布 随机变量函数的分布