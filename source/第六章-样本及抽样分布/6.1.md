# 第六章 样本及抽样分布

前面五章我们讲述了概率论的基本内容，随后的四章将讲述数理统计.数理统计是具有广泛应用的一个数学分支，它以概率论为理论基础，根据试验或观察得到的数据，来研究随机现象，对研究对象的客观规律性作出种种合理的估计和判断
数理统计的内容包括：如何收集、整理数据资料；如何对所得的数据资料进行分析、研究，从而对所研究的对象的性质、特点作出推断.后者就是我们所说的统计推断问题.本书只讲述统计推断的基本内容。
在概率论中，我们所研究的随机变量，它的分布都是假设已知的，在这一前提下去研究它的性质、特点和规律性，例如求出它的数字特征，讨论随机变量函数的分布，介绍常用的各种分布等.在数理统计中，我们研究的随机变量，它的分布是未知的，或者是不完全知道的，人们是通过对所研究的随机变量进行重复独立的观察，得到许多观察值，对这些数据进行分析，从而对所研究的随机变量的分布作出种种推断的.
本章我们介绍总体、随机样本及统计量等基本概念，并着重介绍几个常用统
计量及抽样分布.

# $\S1$随机样本

我们知道，随机试验的结果很多是可以用数来表示的，另有一些试验的结果虽是定性的，但总可以将它数量化.例如，检验某个学校学生的血型这一试验，其可能结果有 O型、A 型 , B 型 、 A B 型 4 种 ,是定性的.如果分别以 1,2,3,4 依次记这 4 种血型，那么试验的结果就能用数来表示了.
在数理统计中，我们往往研究有关对象的某一项数量指标(例如研究某种型号灯泡的寿命这一数量指标).为此，考虑与这一数量指标相联系的随机试验，对这一数量指标进行试验或观察.我们将试验的全部可能的观察值称为总体，这些值不一定都不相同，数目上也不一定是有限的，每一个可能观察值称为个体.总体中所包含的个体的个数称为总体的容量.容量为有限的称为有限总体，容量为无限的称为无限总体.
例如在考察某大学一年级男生的身高这一试验中，若一年级男生共2 000 人，每个男生的身高是一个可能观察值，所形成的总体中共含 2 000 个可能观察值，是一个有限总体.又如考察某一湖泊中某种鱼的含汞量，所得总体也是有限总体，观察并记录某一地点每天(包括以往、现在和将来)的最高气温，或者测量一湖泊任一地点的深度，所得总体是无限总体.有些有限总体的容量很大，我们可以认为它是一个无限总体.例如，考察全国正在使用的某种型号灯泡的寿命所形成的总体，由于可能观察值的个数很多，就可以认为是无限总体.
总体中的每一个个体是随机试验的一个观察值，因此它是某一随机变量 X 的值，这样，一个总体对应于一个随机变量$X.$我们对总体的研究就是对一个随机变量$X$的研究，$X$的分布函数和数字特征就称为总体的分布函数和数字特征.今后将不区分总体与相应的随机变量，笼统称为总体$X.$
例如，我们检验自生产线出来的零件是次品还是正品，以 0 表示产品为正品，以1表示产品为次品.设出现次品的概率为$p$(常数),那么总体是由一些“1”和一些“0”所组成，这一总体对应于一个具有参数为$p$的(0-1)分布：
$P\left \{ X= x\right \} = p^{x}\left ( 1- p\right ) ^{1- x}$, $x= 0, 1$


的随机变量.我们就将它说成是(0-1)分布总体.意指总体中的观察值是(0-1)

分布随机变量的值.又如上述灯泡寿命这一总体是指数分布总体，意指总体中的
观察值是指数分布随机变量的值.
在实际中，总体的分布一般是未知的，或只知道它具有某种形式而其中包含着未知参数.在数理统计中，人们都是通过从总体中抽取一部分个体，根据获得的数据来对总体分布作出推断的.被抽出的部分个体叫做总体的一个样本
所谓从总体抽取一个个体，就是对总体 X 进行一次观察并记录其结果.我们在相同的条件下对总体$X$进行$n$次重复的、独立的观察.将$n$次观察结果按试验的次序记为$X_1,X_2,\cdotp\cdotp\cdotp,X_n.$由于$X_1,X_2,\cdotp\cdotp\cdotp,X_n$ 是对随机变量 $X$ 观察的结果，且各次观察是在相同的条件下独立进行的，所以有理由认为$X_1,X_2,\cdots,X$, 是相互独立的，且都是与$X$具有相同分布的随机变量.这样得到的$X_1,X_2,\cdots$, $X_n$称为来自总体$X$的一个简单随机样本，$n$称为这个样本的容量.以后如无特别说明，所提到的样本都是指简单随机样本.
当$n$ 次观察一经完成，我们就得到一组实数 $x_1,x_2,\cdotp\cdotp\cdotp,x_n$,它们依次是随机
变量 $X_1,X_2,\cdots,X_n$ 的观察值，称为样本值.
对于有限总体，采用放回抽样就能得到简单随机样本，但放回抽样使用起来不方便，当个体的总数 N 比要得到的样本的容量$n$大得多时，在实际中可将不放回抽样近似地当作放回抽样来处理。
至于无限总体，因抽取一个个体不影响它的分布，所以总是用不放回抽样。例如，在生产过程中，每隔一定时间抽取一个个体，抽取$n$个就得到一个简单随机样本，实验室中的记录，水文、气象等观察资料都是样本.试制新产品得到的样品的质量指标，也常被认为是样本.
综合上述，我们给出以下的定义.
定义 设$X$是具有分布函数$F$的随机变量，若$X_1,X_2,\cdotp\cdotp\cdotp,X_n$是具有同一分布函数$F$的、相互独立的随机变量，则称$X_1,X_2,\cdotp\cdotp\cdotp,X_n$为从分布函数$F$ (或总体$F$、或总体$X$)得到的容量为$n$的简单随机样本，简称样本，它们的观察值$x_{1},x_{2},\cdots,x_{n}$称为样本值，又称为$X$的$n$个独立的观察值.
也可以将样本看成是一个随机向量，写成($X_1,X_2,\cdots,X_n)$,此时样本值相应地写成$(x_1,x_2,\cdots,x_n).$若$(x_1,x_2,\cdots,x_n)$与$(y_1,y_2,\cdots,y_n)$都是相应于样本$(X_1,X_2,\cdots,X_n$)的样本值，一般来说它们是不相同的.
由定义得：若 $X_1,X_2,\cdotp\cdotp\cdotp,X_n$ 为$F$ 的一个样本 ,则 $X_1,X_2,\cdotp\cdotp\cdotp,X_n$ 相互独立，
且它们的分布函数都是 $F$,所以($X_1,X_2,\cdots,X_n)$的分布函数为

$$F^{*}\left(x_{1},x_{2},\cdots,x_{n}\right)=\prod_{i=1}^{n}F(x_{i}).$$

又若 X 具有概率密度 $f$,则$(X_1,X_2,\cdotp\cdotp\cdotp,X_n)$的概率密度为

$$f^*(x_1,x_2,\cdots,x_n)=\prod_{i=1}^nf(x_i).$$

# 82 直方图和箱线图

为了研究总体分布的性质，人们通过试验得到许多观察值，一般来说这些数据是杂乱无章的.为了利用它们进行统计分析，将这些数据加以整理，还常借助于表格或图形对它们加以描述.本节将通过例子对连续型随机变量$X$引人“频率直方图”,接着介绍数据的“箱线图”.它们使人们对总体 X 的分布有一个粗略的了解。

(-)直方图

例 1 下面列出了 84 个伊特鲁里亚人(Etruscans)男子的头颅的最大宽度
(以 mm 计),现在来画这些数据的“频率直方图”.

140 137 152 145

解 这些数据杂乱无章，先要将它们进行整理.这些数据的最小值、最大值分别为 126、158,即所有数据落在区间[126,158]上，现取区间[124,5,159.5],它能覆盖区间[126,158].将区间[124.5,159.5]等分为7个小区间$^{\textcircled{\mathrm{w}}}$,小区间的长度记为$\Delta,\Delta=(159.5-124.5)/7=5.\Delta$称为组距.小区间的端点称为组限.数出落在每个小区间内的数据的频数 $f_i$,算出频率 $f_i/n$ ($n=84,i=1,2,\cdots,7$)如下表

<table>
	<tbody>
		<tr>
			<th>组</th>
			<th>限</th>
			<th>频数$f_i$</th>
			<th>频率$f_i/n$</th>
			<th>累积频率</th>
		</tr>
		<tr>
			<td colspan="2">$124.5\sim129.5$</td>
			<td>1</td>
			<td>0.0119</td>
			<td>0.0119</td>
		</tr>
		<tr>
			<td>129.5</td>
			<td>$\sim134.5$</td>
			<td>4</td>
			<td>0.0476</td>
			<td>0.0595</td>
		</tr>
		<tr>
			<td>134.5.</td>
			<td>$\sim139.5$</td>
			<td>10</td>
			<td>0.1191</td>
			<td>0.1786</td>
		</tr>
		<tr>
			<td>139.5</td>
			<td>$\sim144.5$</td>
			<td>33</td>
			<td>0.3929</td>
			<td>0.5715</td>
		</tr>
		<tr>
			<td>144.! 5</td>
			<td>$\sim149.5$</td>
			<td>24</td>
			<td>0.2857</td>
			<td>0.8572</td>
		</tr>
		<tr>
			<td>149.5.</td>
			<td>$\sim154.5$</td>
			<td>9</td>
			<td>0.1071</td>
			<td>0.9643</td>
		</tr>
		<tr>
			<td colspan="2">$154.5\sim159.5$</td>
			<td>3</td>
			<td>0.0357</td>
			<td>1</td>
		</tr>
	</tbody>
</table>

现在自左至右依次在各个小区间上作以$\frac{f_i}n/\Delta$ 为高的小矩形.如图 6-1 所示，这样的图形叫频率直方图.显然这种小矩形的面积就等于数据落在该小区间的频率$f_i/n.$由于当$n$很大时，频率接近于概率，因而一般来说，每个小区间上的小矩形面积接近于概率密度曲线之下该小区间之上的曲边梯形的面积.于是，一般来说，直方图的外廓曲线接近于总体$X$的概率密度曲线.从本例的直方图看(图6-1),它有一个峰，中间高，两头低，比较对称.看起来样本很像来自某一正态总体$X$(在第八章中将进一步讨论).从直方图上还可以估计 $X$ 落在某一区间的概率，例如从图上看到有 51.2%的人最大头颅宽度落在区间(134,5,144,5)之
$\square$
内，最大头颅宽度小于 129.5 的仅占 1.19%,等等。

# (二)箱线图

先介绍样本分位数.

定义 设有容量为$n$的样本观察值$x_1,x_2,\cdotp\cdotp\cdotp,x_n$,样本$p$分位数(0<p<1)记

为 $x_{p}$,它具有以下的性质：(1)至少有 np个观察值小于或等于 $x_{p}.$(2)至少

有 $n(1-p)$个观察值大于或等于 $x_p.$

$\textcircled{1}$作直方图时，先取一个区间，其下限比最小的数据稍小，其上限比最大的数据稍大，然后将这一区间分为及个小区间，通常当$n$较大时火取 10~20,当$n<50$ 时反取 5~6.若大取得过大，则会出现某些小区间内频数为零的情况(一般应设法避免).分点通常取得比数据精度高一位，以免数据落在分点上.

![](https://storage.simpletex.cn/view/fXHPBcELaO5lo6v16e2IDnLoSv9HQzHYe)
$图6-1$

样本$p$分位数可按以下法则求得.将$x_1,x_2,\cdotp\cdotp\cdotp,x_n$按自小到大的次序排列
成$x_{( 1) }\leqslant x_{( 2) }\leqslant \cdots \leqslant x_{( n) }$ .
$1^{\circ}$若$np$不是整数，则只有一个数据满足定义中的两点要求，这一数据位于大于$np$的最小整数处，即为位于[$np]+1$处的数.例如$,n=12,p=0.9,np=$ $10.8,n(1-p)=1.2$,则 $x_{\rho}$ 的位置应满足至少有 10.8 个数据$\leqslant x_{\rho}(x_{\rho}$ 应位于第11 或大于第 11 处);且至少有 1.2 个数据$\geqslant x_{p}(x_{p}$ 应位于第 11 或小于第 11处),故$x_{\rho}$应位于第 11 处
2°若$np$是整数.例如在$n=20,p=0.95$时$,x_{\rho}$的位置应满足至少有 19 个数据$\leqslant x_p(x_p$ 应位于第 19 或大于第 19 处)且至少有 1 个数据$\geqslant x_{p}(x_{p}$ 应位于第20 或小于第 20 处),故第 19 或第 20 的数据均符合要求，就取这两个数的平均值作为$x_{_p}.$
综上，

$x_{p}=\begin{cases}x_{([np]+1)}&\text{当 }np\text{ 不是整数，}\\\frac{1}{2}\Big[x_{(np)}+x_{(np+1)}\Big],&\text{当 }np\text{ 是整数}.\end{cases}$

特别，当$p=0.5$时 ,0.5 分位数$x_{0.5}$也记为$Q_2$或$M$,称为样本中位数，即有

$x_{0.5}=\begin{cases}x_{([\frac{n}{2}]+1)},&\text{当}n\text{是奇数},\\[1-x_{(\frac{n}{2})}+x_{(\frac{n}{2}+1)}],&\text{当}n\text{是偶数}.\end{cases}$

易知，当$n$是奇数时中位数$x_0.5$就是$x_(1)\leqslant x_{(2)}\leqslant\cdotp\cdotp\cdotp\leqslant x_{(n)}$这一数组中最中间的一个数；而当$n$是偶数时中位数$x_\text{0.5 就是 }x_{(1)}\leqslant x_{(2)}\leqslant\cdots\leqslant x_{(n)}$这一数组中最中间两个数的平均值.
0.25 分位数 $x_{0.25}$称为第一四分位数，又记为$Q_1;0.75$ 分位数 $x_{0.75}$称为第三
四分位数，又记为$Q_3.x_{0.25},x_{0.5},x_{0.75}$在统计中是很有用的.
例 2 设有一组容量为 18 的样本值如下(已经过排序):

122 126 133 140 145 145 149 150 157

162 166 175 177 177 183 188 199 212

求样本分位数：$x_0.2,x_{0.25},x_{0.5}.$
解 因为 $np=18\times0.2=3.6,x_{0.2}$位于第[3.6]+1=4 处，即有
$x_{0.2}=x_{(4)}=140.$
因为 $np=18\times0.25=4.5,x_{0.25}$位于第[4.5]+1=5 处，即有$x_0.25=145.$
因为 $np=18\times0.5=9,x_{0.5}$是这组数中间两个数的平均值，即有

$$x_{0.5}=\frac{1}{2}(157+162)=159.5.$$

$\square$

下面介绍箱线图.
数据集的箱线图是由箱子和直线组成的图形，它是基于以下 5 个数的图形概括：最小值 Min,第一四分位数$Q_{1}$,中位数$M$,第三四分位数$Q_{3}$和最大值Max. 它的作法如下：
(1)画一水平数轴，在轴上标上 Min$,Q_1,M,Q_3$,Max.在数轴上方画一个上、下侧平行于数轴的矩形箱子，箱子的左右两侧分别位于$Q_1,Q_3$ 的上方.在$M$ 点的上方画一条垂直线段.线段位于箱子内部。

![](https://storage.simpletex.cn/view/fMFOFGWKZwZkzlCyAkRwwnYahWTQ0dBqr)
如图 6一2 所示.箱线图也可以沿垂直数轴来 Min ${\overline {Q_1}}$
图 6-2

(2)自箱子左侧引一条水平线直至最小值 Min,在同一水平高度自箱子右侧引一条水平线直至最大值.这样就将箱线图作好了， 作.自箱线图可以形象地看出数据集的以下重要性质.


$\textcircled{1}$中心位置：中位数所在的位置就是数据集的中心。
$\textcircled{2}$ 散布程度：全部数据都落在[Min,Max]之内，在区间[Min$,Q_1],[Q_1$, $M],[M,Q_{3}],[Q_{3}$,Max]上的数据个数各约占1/4.区间较短时，表示落在该区间的点较集中，反之较为分散.
(3)关于对称性：若中位数位于箱子的中间位置，则数据分布较为对称.又若 Min 离$M$的距离较 Max 离$M$的距离大，则表示数据分布向左倾斜，反之表示数据向右倾斜，且能看出分布尾部的长短.
例 3 以下是8个患者的血压(收缩压，以 mmHg 计)数据(已经过排序),

试作出箱线图.

102 110 117 118 122 123 132 150

 母  因  $np= 8\times 0. 25= 2$,故 $x_{0.25}=Q_{1}=\frac{1}{2}(110+117)=113.5.$

因 $np=8\times0.5=4$,故 $x_{0.5}=Q_{2}=\frac{1}{2}(118+122)=120$

$\square$

因 $np=8\times0.75=6$,故 $x_{0.75}=Q_{3}=\frac{1}{2}(123+132)=127.5.$
Min= 102 , Max= 150 , 作 出 箱 线 图 如 图 6- 3 所 示 . 
例 4 下面分别给出了 25 个男子和 25 个女子的肺活量(以 L 计.数据已经
$\begin{aligned}&\text{排过序):}\\&\text{女子组 }&2.7&2.8&2.9&3.1&3.1&3.1&3.2&3.4&3.4\\&&3.4&3.4&3.4&3.5&3.5&3.5&3.6&3.7&3.7\\&&3.7&3.8&3.8&4.0&4.1&4.2&4.2&4.2\\&\text{男子组 }&4.1&4.1&4.3&4.3&4.5&4.6&4.7&4.8&4.8\\&5.1&5.3&5.3&5.3&5.4&5.4&5.5&5.6&5.7\\&5.8&5.8&5.8&6.0&6.1&6.3&6.7&6.7\end{aligned}$


试分别画出这两组数据的箱线图.

解 女子组 Min=2.7,Max=4.2,M=3.5.
因$np=25\times0.25=6.25,Q_1=3.2.$ 因$np=25\times0.75=18.75,Q_{3}=3.7.$ 男子组 Min=4.1,Max=6.7,M=5.3. 因$np=25\times0.25=6.25,Q_{1}=4.7.$ 因$np=25\times0.75=18.75,Q_{3}=5.8.$ 作出箱线图如图 6-4 所示.


口

![](https://storage.simpletex.cn/view/f70pHwvGgzCMDBlAdUsawowN5rdHDoFZs)


箱线图特别适用于比较两个或两个以上数据集的性质，为此，我们将几个数据集的箱线图画在同一个数轴上.例如在例 4 中可以明显地看到男子的肺活量要比女子大，男子的肺活量较女子的肺活量更为分散.
若在数据集中某一个观察值不寻常地大于或小于该数集中的其他数据，则称之为疑似异常值.疑似异常值的存在，会对随后的计算结果产生不适当的影响.检查疑似异常值并加以适当的处理是十分重要的.箱线图只要稍加修改，就能用来检测数据集是否存在疑似异常值。
第一四分位数$Q_1$与第三四分位数$Q_3$之间的距离：$Q_3-Q_1\xrightarrow\text{记成}IQR$,称为四分位数间距.若数据小于$Q_1-1.5IQR$ 或大于$Q_3+1.5IQR$,就认为它是疑似
异常值.我们将上述箱线图的作法(1),(2),(3)作如下的改变：
$(1^{\prime})$同(1).
$(2^{\prime})$计算$IQR=Q_3-Q_1$,若一个数据小于$Q_1-1.5IQR$或大于$Q_3+$
$1.5IQR,则认为它是一个疑似异常值.画出疑似异常值，并以*表示.$
(3')自箱子左侧引一水平线段直至数据集中除去疑似异常值后的最小值，
又自箱子右侧引一水平线直至数据集中除去疑似异常值后的最大值，
按(1'),(2'),(3')作出的图形称为修正箱线图，
例 5 下面给出了某医院 21 个患者的住院时间(以天计),试画出修正箱线
图(数据已经过排序).

$\begin{array}{ccccccccccccccccc}1&2&3&3&4&4&5&6&6&7&7&9&9\\10&12&12&13&15&18&23&55\end{array}$
解 Min=1,Max=55,M=7. 因 21$\times0.25=5.25$,得 $Q_1=4.$ 又 21$\times0.75=15.75$,得 $Q_{3}=12.$
故 $IQR=Q_3-Q_1=8$,
$Q_{3}+ 1. 5IQR= 12+ 1. 5\times 8= 24$, $Q_{1}- 1. 5IQR= 4- 12= - 8.$
观察值 55>24,故 55 是疑似异常值，且仅此一个疑似异常值.作出修正箱线图如图 6-5 所示.可见数据分布不对称，而向右倾斜，在中位数的右边较为
$\square$
分散.
![](https://storage.simpletex.cn/view/fDt0t9oCYNKxLypwpPaSfzvtMVBE5zKvf)




$图6-5$



数据集中，疑似异常值的产生源于：(1)数据的测量、记录或输人计算机时的错误.(2)数据来自不同的总体.(3)数据是正确的，但它只体现小概率事件. 当检测出疑似异常值时，人们需对疑似异常值出现的原因加以分析.如果是由于测量或记录的错误，或某些其他明显的原因造成的，那么将这些疑似异常值从数据集中丢弃就可以了.然而当出现的原因无法解释时，要作出丢弃或保留这些值的决策无疑是困难的，此时我们在对数据集作分析时尽量选用稳健的方法，使得疑似异常值对我们的结论的影响较小.例如我们采用中位数来描述数据集的中心趋势，而不使用数据集的平均值，因为后者受疑似异常值的影响较大.